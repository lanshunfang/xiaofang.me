<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset=UTF-8>
    <meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=3.0, minimum-scale=1.0"/>
    <title>微信网站微信中继...</title>
    <link id=favicon rel=icon href type=image/gif sizes=16x16>
    <style>#wechat_iframe{position:absolute;left:-2px;top:-2px;right:-2px;bottom:-2px}#loading{position:absolute;top:20px;left:20px;right:20px;background:#fff;opacity:.9;transition:all 2s}#loading p.default{margin-bottom:0}#loading .loading-longer{color:#ff6708}#loading .loading-connected{color:#0061b9}#wechat_img,#wechat_summary{height:1px;width:1px;overflow:hidden;opacity:.1;position:fixed;bottom:0;left:0}.hide{display:none}.website-host{font-weight:bold;font-style:italic}.link{color:#0061b9}.website-title-extra{font-size:14px}</style>
</head>
<body>
<div id=wechat_img><img id=featured width=800 height=600 src=""/></div>
<div id=wechat_summary>守望的微信网站跳转中……</div>
<iframe id=wechat_iframe height=100% width=100% src>
</iframe>
<h1 id=loading>
    <p class=default>正在载入网站 <span class="website-host link"></span> ... </p>
    <p class="loading-connected hide">网站已经连接成功，正在加载完整数据....</p>
    <p class="loading-longer hide">不好意思，好像加载时间略长一些，请再耐心等等。</p>
    <p class="loading-failure hide">
        如果不想等，请点击微信右上角，选择"在浏览器(Safari/QQ)打开"；或者直接在你的手机浏览器里输入 <span class=website-host></span>：
    </p>
    <p class="unload hide">正在打开新网页……<span class="website-title link"></span><br/><br/>(<span class=website-title-extra></span>)</p>
</h1>
<script>(function(){var e=document;var B=window;var o;var i=location;var A;var x=false;var G=e.querySelector("#loading");var q=e.querySelector("#loading .default");var r=e.querySelector("#loading .loading-connected");var f=e.querySelector("#loading .loading-longer");var k=e.querySelector("#loading .loading-failure");var a=e.querySelector("#loading .unload");var w=e.querySelector(".website-title");var j=e.querySelector(".website-title-extra");var g=e.querySelector("#wechat_iframe");var l=e.getElementById("favicon");var p=e.getElementById("featured");var c=setInterval(s,500);var y="/--WC--";var C=new RegExp(y,"g");var h="loadingIFrame";var d=new Event(h);var v="https://";var u=i.pathname.replace(/\//,"").split("/")[0];l.href="/"+u+"/favicon.ico";p.src="/"+u+"/banner.png";m();B.addEventListener("message",function(Q){var O=Q.data;switch(O.msgTitle){case"connected":if(x){return}x=true;clearTimeout(A);I(q,f,k,a);z(r);setTimeout(function(){I(r);K(G)},500);break;case"updateParent":clearInterval(c);var S=O.title;var N=O.description;var L=O.faviconUrl;var R=o=O.url;if(!R){return}if(O.isReplaceHref){i.href=R.replace(/^\/\//g,"http://")}else{e.title=S;var M=R.replace(v,"").replace("#",y);t(M);if(O.imgSrc){p.src=O.imgSrc}if(N){e.getElementById("wechat_summary").innerText=N}if(L){l.setAttribute("href",L)}}break;case"beforeunload":z(a);w.innerText=O.targetTitle;var P=O.targetTitleExtra;j.innerText=F(P);E(G);J(P);break;case"unload":x=false;break}});e.addEventListener(h,function(L){D()},false);e.addEventListener("DOMContentLoaded",function(){e.dispatchEvent(d);n()});B.addEventListener("popstate",function(L){var M=g.contentWindow;if(!M){return}M.postMessage({type:"updateIFrameUrlByState",url:b()},"*")},false);function m(){var L=decodeURI(i.hash.replace(/^#/,"").replace(v,""));if(L.length>3){t(L)}}function H(L){return v+L.replace(C,"#")}function t(M){var N=g.contentWindow;if(!N){return}var L="/"+u+"/"+M;history.pushState({},"",L);setTimeout(function(){var P=localStorage.getItem("lastIFrameUrl");var O=localStorage.getItem("lastIFrameUrlDateTime");var Q=new Date().valueOf();localStorage.setItem("lastIFrameUrl",L);if(P!==L&&L&&L.length>10){if(O&&(+O)+5000<Q){localStorage.setItem("lastIFrameUrlDateTime",Q);i.reload()}}},10)}function D(){var L=b();if(g.src!=L){g.src=L}[].forEach.call(e.querySelectorAll(".website-host"),function(M){M.innerText=F(L)})}function b(){var M,P;P=i.pathname.replace(/^\//,"");M=P.replace(u,"");var O=u.split(".").length>2?v:v+"www.";var N=O+u;if(M&&M.length>5){var L=H(M);if(g.src!=L&&o!==L){N=L}}return N}function n(){A=setTimeout(function(){q.style.display="none";f.style.display="block";A=setTimeout(function(){f.style.display="none";k.style.display="block";A=setTimeout(function(){k.style.display="none"},5000)},8000)},7000)}function s(){var L=g.contentWindow;if(!L){return}L.postMessage({type:"wechat_unblocker"},"*")}function I(){[].forEach.call(arguments,function(L){L.style.display="none"})}function z(L){[].forEach.call(arguments,function(M){M.style.display="block"})}function K(L){L.style.transform="translate(0px, -100px)";L.style.opacity=0.5;setTimeout(function(){I(L)},1000)}function E(L){z(L);L.style.transform="translate(0px, 0px)";L.style.opacity=1}function J(L){if(L&&L.length>10){var M=L.replace(v,"").replace("#",y);t(M)}}function F(L){L=L||"";var M=L.split("/").reverse().reduce(function(N,O){O=decodeURIComponent(O);if(O&&O.length>5&&O.length>N.length){return O}else{return N}},"");return M&&/[\u4E00-\u9FA5]+/.test(M)?M:L}})();</script>
</body>
</html>