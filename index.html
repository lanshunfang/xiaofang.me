<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset=UTF-8>
    <meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=3.0, minimum-scale=1.0"/>
    <title>微信网站微信中继...</title>
    <link id=favicon rel=icon href type=image/gif sizes=16x16>
    <style>#wechat_iframe{position:absolute;left:-2px;top:-2px;right:-2px;bottom:-2px}#loading{position:absolute;top:20px;left:20px;right:20px;background:#fff;opacity:.9;transition:all 2s}#loading p.default{margin-bottom:0}#loading .loading-longer{color:#ff6708}#loading .loading-connected{color:#0061b9}#wechat_img,#wechat_summary{height:1px;width:1px;overflow:hidden;opacity:.1;position:fixed;bottom:0;left:0}.hide{display:none}.website-host{font-weight:bold;font-style:italic}.link{color:#0061b9}.website-title-extra{font-size:14px}</style>
</head>
<body>
<div id=wechat_img><img id=featured width=800 height=600 src=""/></div>
<div id=wechat_summary>守望的微信网站跳转中……</div>
<iframe id=wechat_iframe height=100% width=100% src>
</iframe>
<h1 id=loading>
    <p class=default>正在载入网站 <span class="website-host link"></span> ... </p>
    <p class="loading-connected hide">网站已经连接成功，正在加载完整数据....</p>
    <p class="loading-longer hide">不好意思，好像加载时间略长一些，请再耐心等等。</p>
    <p class="loading-failure hide">
        如果不想等，请点击微信右上角，选择"在浏览器(Safari/QQ)打开"；或者直接在你的手机浏览器里输入 <span class=website-host></span>：
    </p>
    <p class="unload hide">正在打开新网页……<span class="website-title link"></span><br/><br/>(<span class=website-title-extra></span>)</p>
</h1>
<script>(function(){var g=document;var D=window;var q;var k=location;var C;var z=false;var a=0;var I=g.querySelector("#loading");var s=g.querySelector("#loading .default");var t=g.querySelector("#loading .loading-connected");var h=g.querySelector("#loading .loading-longer");var m=g.querySelector("#loading .loading-failure");var b=g.querySelector("#loading .unload");var y=g.querySelector(".website-title");var l=g.querySelector(".website-title-extra");var i=g.querySelector("#wechat_iframe");var n=g.getElementById("favicon");var r=g.getElementById("featured");var e=setInterval(u,500);var A="/--WC--";var E=new RegExp(A,"g");var j="loadingIFrame";var f=new Event(j);var x="https://";var w=k.pathname.replace(/\//,"").split("/")[0];n.href="/"+w+"/favicon.ico";r.src="/"+w+"/banner.png";o();D.addEventListener("message",function(S){var Q=S.data;switch(Q.msgTitle){case"connected":a=new Date().valueOf();if(z){return}z=true;clearTimeout(C);K(s,h,m,b);B(t);setTimeout(function(){K(t);M(I)},500);break;case"updateParent":clearInterval(e);var U=Q.title;var P=Q.description;var N=Q.faviconUrl;var T=q=Q.url;if(!T){return}if(Q.isReplaceHref){k.href=T.replace(/^\/\//g,"http://")}else{g.title=U;var O=T.replace(x,"").replace("#",A);v(O);if(Q.imgSrc){r.src=Q.imgSrc}if(P){g.getElementById("wechat_summary").innerText=P}if(N){n.setAttribute("href",N)}}break;case"beforeunload":B(b);y.innerText=Q.targetTitle;var R=Q.targetTitleExtra;l.innerText=H(R);G(I);L(R);break;case"unload":z=false;break}});g.addEventListener(j,function(N){F()},false);g.addEventListener("DOMContentLoaded",function(){g.dispatchEvent(f);p()});D.addEventListener("popstate",function(N){var O=i.contentWindow;if(!O){return}O.postMessage({type:"updateIFrameUrlByState",url:c()},"*")},false);function o(){var N=decodeURI(k.hash.replace(/^#/,"").replace(x,""));if(N.length>3){v(N)}}function J(N){return x+N.replace(E,"#")}function v(O){var P=i.contentWindow;if(!P){return}var N="/"+w+"/"+O;history.pushState({},"",N);setTimeout(function(){var R=localStorage.getItem("lastIFrameUrl");var Q=localStorage.getItem("lastIFrameUrlDateTime");var S=new Date().valueOf();localStorage.setItem("lastIFrameUrl",N);localStorage.setItem("lastIFrameUrlDateTime",S);if(R!==N&&N&&N.length>10){if(Q&&(+Q)+3000<S&&S>a+5000){d()}}},10)}function d(){var N=g.createEvent("Event");N.initEvent("load",false,false);D.dispatchEvent(N);N=g.createEvent("HTMLEvents");N.initEvent("load",true,true);g.dispatchEvent(N)}function F(){var N=c();if(i.src!=N){i.src=N}[].forEach.call(g.querySelectorAll(".website-host"),function(O){O.innerText=H(N)})}function c(){var O,R;R=k.pathname.replace(/^\//,"");O=R.replace(w,"");var Q=w.split(".").length>2?x:x+"www.";var P=Q+w;if(O&&O.length>5){var N=J(O);if(i.src!=N&&q!==N){P=N}}return P}function p(){C=setTimeout(function(){s.style.display="none";h.style.display="block";C=setTimeout(function(){h.style.display="none";m.style.display="block";C=setTimeout(function(){m.style.display="none"},5000)},8000)},7000)}function u(){var N=i.contentWindow;if(!N){return}N.postMessage({type:"wechat_unblocker"},"*")}function K(){[].forEach.call(arguments,function(N){N.style.display="none"})}function B(N){[].forEach.call(arguments,function(O){O.style.display="block"})}function M(N){N.style.transform="translate(0px, -100px)";N.style.opacity=0.5;setTimeout(function(){K(N)},1000)}function G(N){B(N);N.style.transform="translate(0px, 0px)";N.style.opacity=1}function L(N){if(N&&N.length>10){var O=N.replace(x,"").replace("#",A);v(O)}}function H(N){N=N||"";var O=N.split("/").reverse().reduce(function(P,Q){Q=decodeURIComponent(Q);if(Q&&Q.length>5&&Q.length>P.length){return Q}else{return P}},"");return O&&/[\u4E00-\u9FA5]+/.test(O)?O:N}})();</script>
</body>
</html>