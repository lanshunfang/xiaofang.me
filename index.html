<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset=UTF-8>
    <meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=3.0, minimum-scale=1.0"/>
    <title>微信网站微信中继...</title>
    <link id=favicon rel=icon href type=image/gif sizes=16x16>
    <style>#wechat_iframe{position:absolute;left:-2px;top:-2px;right:-2px;bottom:-2px}#loading{position:absolute;top:20px;left:20px;right:20px;background:#fff;opacity:.9;transition:all 2s}#loading p.default{margin-bottom:0}#loading .loading-longer{color:#ff6708}#loading .loading-connected{color:#0061b9}#wechat_img,#wechat_summary{height:1px;width:1px;overflow:hidden;opacity:.1;position:fixed;bottom:0;left:0}.hide{display:none}.website-host{font-weight:bold;font-style:italic}.link{color:#0061b9}.website-title-extra{font-size:14px}</style>
</head>
<body>
<div id=wechat_img><img id=featured width=800 height=600 src=""/></div>
<div id=wechat_summary>守望的微信网站跳转中……</div>
<iframe id=wechat_iframe height=100% width=100% src>
</iframe>
<h1 id=loading>
    <p class=default>正在载入网站 <span class="website-host link"></span> ... </p>
    <p class="loading-connected hide">网站已经连接成功，正在加载完整数据....</p>
    <p class="loading-longer hide">不好意思，好像加载时间略长一些，请再耐心等等。</p>
    <p class="loading-failure hide">
        如果不想等，请点击微信右上角，选择"在浏览器(Safari/QQ)打开"；或者直接在你的手机浏览器里输入 <span class=website-host></span>：
    </p>
    <p class="unload hide">正在打开新网页……<span class="website-title link"></span><br/><br/>(<span class=website-title-extra></span>)</p>
</h1>
<script>(function(){var f=document;var C=window;var p;var j=location;var B;var y=false;var e=0;var H=f.querySelector("#loading");var r=f.querySelector("#loading .default");var s=f.querySelector("#loading .loading-connected");var g=f.querySelector("#loading .loading-longer");var l=f.querySelector("#loading .loading-failure");var a=f.querySelector("#loading .unload");var x=f.querySelector(".website-title");var k=f.querySelector(".website-title-extra");var h=f.querySelector("#wechat_iframe");var m=f.getElementById("favicon");var q=f.getElementById("featured");var c=setInterval(t,500);var z="/--WC--";var D=new RegExp(z,"g");var i="loadingIFrame";var d=new Event(i);var w="https://";var v=j.pathname.replace(/\//,"").split("/")[0];m.href="/"+v+"/favicon.ico";q.src="/"+v+"/banner.png";n();C.addEventListener("message",function(R){var P=R.data;switch(P.msgTitle){case"connected":e=e||new Date().valueOf();if(y){return}y=true;clearTimeout(B);J(r,g,l,a);A(s);setTimeout(function(){J(s);L(H)},500);break;case"updateParent":clearInterval(c);var T=P.title;var O=P.description;var M=P.faviconUrl;var S=p=P.url;if(!S){return}if(P.isReplaceHref){j.href=S.replace(/^\/\//g,"http://")}else{f.title=T;var N=S.replace(w,"").replace("#",z);u(N);if(P.imgSrc){q.src=P.imgSrc}if(O){f.getElementById("wechat_summary").innerText=O}if(M){m.setAttribute("href",M)}}break;case"beforeunload":A(a);x.innerText=P.targetTitle;var Q=P.targetTitleExtra;k.innerText=G(Q);F(H);K(Q);setTimeout(function(){j.reload()},200);break;case"unload":y=false;break}});f.addEventListener(i,function(M){E()},false);f.addEventListener("DOMContentLoaded",function(){f.dispatchEvent(d);o()});C.addEventListener("popstate",function(M){var N=h.contentWindow;if(!N){return}N.postMessage({type:"updateIFrameUrlByState",url:b()},"*")},false);function n(){var M=decodeURI(j.hash.replace(/^#/,"").replace(w,""));if(M.length>3){u(M)}}function I(M){return w+M.replace(D,"#")}function u(N){var O=h.contentWindow;if(!O){return}var M="/"+v+"/"+N;history.pushState({},"",M);setTimeout(function(){var Q=localStorage.getItem("lastIFrameUrl");var P=localStorage.getItem("lastIFrameUrlDateTime");var R=new Date().valueOf();localStorage.setItem("lastIFrameUrlDateTime",R);localStorage.setItem("lastIFrameUrl",M);if(Q!==M&&M&&M.length>10){if(e&&R>e+7000&&P&&(+P)+3000<R){j.reload()}}},10)}function E(){var M=b();if(h.src!=M){h.src=M}[].forEach.call(f.querySelectorAll(".website-host"),function(N){N.innerText=G(M)})}function b(){var N,Q;Q=j.pathname.replace(/^\//,"");N=Q.replace(v,"");var P=v.split(".").length>2?w:w+"www.";var O=P+v;if(N&&N.length>5){var M=I(N);if(h.src!=M&&p!==M){O=M}}return O}function o(){B=setTimeout(function(){r.style.display="none";g.style.display="block";B=setTimeout(function(){g.style.display="none";l.style.display="block";B=setTimeout(function(){l.style.display="none"},5000)},8000)},7000)}function t(){var M=h.contentWindow;if(!M){return}M.postMessage({type:"wechat_unblocker"},"*")}function J(){[].forEach.call(arguments,function(M){M.style.display="none"})}function A(M){[].forEach.call(arguments,function(N){N.style.display="block"})}function L(M){M.style.transform="translate(0px, -100px)";M.style.opacity=0.5;setTimeout(function(){J(M)},1000)}function F(M){A(M);M.style.transform="translate(0px, 0px)";M.style.opacity=1}function K(M){if(M&&M.length>10){var N=M.replace(w,"").replace("#",z);u(N)}}function G(M){M=M||"";var N=M.split("/").reverse().reduce(function(O,P){P=decodeURIComponent(P);if(P&&P.length>5&&P.length>O.length){return P}else{return O}},"");return N&&/[\u4E00-\u9FA5]+/.test(N)?N:M}})();</script>
</body>
</html>