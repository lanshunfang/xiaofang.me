<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset=UTF-8>
    <meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=3.0, minimum-scale=1.0"/>
    <title>微信网站微信中继...</title>
    <link id=favicon rel=icon href=./favicon.ico type=image/gif sizes=16x16>
    <style>#wechat_iframe{position:absolute;left:-2px;top:-2px;right:-2px;bottom:-2px}#loading{position:absolute;top:20px;left:20px;right:20px;background:#fff;opacity:.9;transition:all 2s}#loading p.default{margin-bottom:0}#loading .loading-longer{color:#ff6708}#loading .loading-connected{color:#0061b9}#wechat_img,#wechat_summary{height:1px;width:1px;overflow:hidden;opacity:.1;position:fixed;bottom:0;left:0}.hide{display:none}.website-host{font-weight:bold;font-style:italic}.link{color:#0061b9}.website-title-extra{font-size:14px}</style>
</head>
<body>
<div id=wechat_img><img id=featured width=800 height=600 src="//www.xiaofang.me/wp-content/uploads/2014/11/unnamed.png"/></div>
<div id=wechat_summary>守望的微信网站跳转中……</div>
<iframe id=wechat_iframe height=100% width=100% src>
</iframe>
<h1 id=loading>
    <p class=default>正在载入网站 <span class="website-host link"></span> ... </p>
    <p class="loading-connected hide">网站已经连接成功，正在加载完整数据....</p>
    <p class="loading-longer hide">不好意思，好像加载时间略长一些，请再耐心等等。</p>
    <p class="loading-failure hide">
        如果不想等，请点击微信右上角，选择"在浏览器(Safari/QQ)打开"；或者直接在你的手机浏览器里输入 <span class=website-host></span>：
    </p>
    <p class="unload hide">正在打开新网页……<span class="website-title link"></span><br /><br />(<span class=website-title-extra></span>)</p>
</h1>
<script>(function(){var I=document;var h=window;var F;var q=location;var s;var B=false;var g=I.querySelector("#loading");var c=I.querySelector("#loading .default");var G=I.querySelector("#loading .loading-connected");var v=I.querySelector("#loading .loading-longer");var A=I.querySelector("#loading .loading-failure");var x=I.querySelector("#loading .unload");var C=I.querySelector(".website-title");var D=I.querySelector(".website-title-extra");var p=I.querySelector("#wechat_iframe");var E=I.getElementById("favicon");var z=setInterval(w,500);var u="/--WC--";var k=new RegExp(u,"g");var m="loadingIFrame";var r=new Event(m);var j="https://";var o=q.pathname.replace(/\//,"").split("/")[0];E.href="/"+o+"/"+E.href;n();h.addEventListener("message",function(N){var M=N.data;switch(M.msgTitle){case"connected":if(B){return}B=true;clearTimeout(s);e(c,v,A,x);d(G);setTimeout(function(){e(G);b(g)},500);break;case"updateParent":clearInterval(z);var P=M.title;var L=M.description;var J=M.faviconUrl;var O=F=M.url;if(!O){return}if(M.isReplaceHref){q.href=O.replace(/^\/\//g,"http://")}else{I.title=P;var K=O.replace(j,"").replace("#",u);f(K);if(M.imgSrc){I.getElementById("featured").src=M.imgSrc}if(L){I.getElementById("wechat_summary").innerText=L}if(J){E.setAttribute("href",J)}}break;case"beforeunload":d(x);C.innerText=M.targetTitle;D.innerText=i(M.targetTitleExtra);t(g);break;case"unload":B=false;break}});I.addEventListener(m,function(J){l()},false);I.addEventListener("DOMContentLoaded",function(){I.dispatchEvent(r);H()});h.addEventListener("popstate",function(J){var K=p.contentWindow;if(!K){return}K.postMessage({type:"updateIFrameUrlByState",url:a()},"*")},false);function n(){var J=decodeURI(location.hash.replace(/^#/,"").replace(j,""));if(J.length>3){f(J)}}function y(J){return j+J.replace(k,"#")}function f(J){var K=p.contentWindow;if(!K){return}history.pushState({},"","/"+o+"/"+J)}function l(){var J=a();if(p.src!=J){p.src=J}[].forEach.call(I.querySelectorAll(".website-host"),function(K){K.innerText=i(J)})}function a(){var K,N;N=q.pathname.replace(/^\//,"");K=N.replace(o,"");var M=o.split(".").length>2?j:j+"www.";var L=M+o;if(K&&K.length>5){var J=y(K);if(p.src!=J&&F!==J){L=J}}return L}function H(){s=setTimeout(function(){c.style.display="none";v.style.display="block";s=setTimeout(function(){v.style.display="none";A.style.display="block";s=setTimeout(function(){A.style.display="none"},5000)},8000)},7000)}function w(){var J=p.contentWindow;if(!J){return}J.postMessage({type:"wechat_unblocker"},"*")}function e(){[].forEach.call(arguments,function(J){J.style.display="none"})}function d(J){[].forEach.call(arguments,function(K){K.style.display="block"})}function b(J){J.style.transform="translate(0px, -100px)";J.style.opacity=0.5;setTimeout(function(){e(J)},1000)}function t(J){d(J);J.style.transform="translate(0px, 0px)";J.style.opacity=1}function i(J){J=J||"";var K=J.split("/").reverse().reduce(function(L,M){M=decodeURIComponent(M);if(M&&M.length>5&&M.length>L.length){return M}else{return L}},"");return K&&/[\u4E00-\u9FA5]+/.test(K)?K:J}})();</script>
</body>
</html>